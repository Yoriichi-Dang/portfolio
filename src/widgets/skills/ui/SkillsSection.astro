---
import { techStacks } from '@/entities/techstack';
---

<section id="skills" class="py-20">
  <div class="container mx-auto px-4">
    <div class="mx-auto max-w-6xl">
      <h2 class="text-foreground mb-4 text-center text-4xl font-bold md:text-5xl">
        Skills & Technologies
      </h2>
      <p class="text-muted-foreground mb-12 text-center text-lg">
        The skills, tools and technologies I am really working with
      </p>

      <div class="grid grid-cols-3 gap-6 md:grid-cols-7" id="tech-stack-grid">
        {
          techStacks.map((tech) => (
            <div class="border-border bg-card flex flex-col items-center justify-center gap-3 rounded-xl border p-6 shadow-lg">
              <div class="tech-icon-wrapper size-12" data-icon-name={tech.iconName} />
              <span class="text-foreground text-sm font-medium">{tech.name}</span>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>

<script>
  import StackIcon from 'tech-stack-icons';
  import { createRoot } from 'react-dom/client';
  import { createElement } from 'react';

  function renderIcons() {
    const isDark = document.documentElement.classList.contains('dark');
    const variant = isDark ? 'dark' : 'light';

    const wrappers = document.querySelectorAll('.tech-icon-wrapper');
    wrappers.forEach((wrapper) => {
      const iconName = wrapper.getAttribute('data-icon-name');
      if (!iconName) return;

      // Clear previous content
      wrapper.innerHTML = '';

      // Create React root and render icon
      const root = createRoot(wrapper);
      root.render(
        createElement(StackIcon, {
          name: iconName,
          variant: variant,
          className: 'size-12',
        })
      );
    });
  }

  // Initial render
  renderIcons();

  // Observe theme changes
  const observer = new MutationObserver(() => {
    renderIcons();
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class'],
  });
</script>
